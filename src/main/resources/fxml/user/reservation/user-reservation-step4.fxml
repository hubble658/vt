<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<StackPane stylesheets="@../../../css/styles.css"
           xmlns="http://javafx.com/javafx/21"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.studyflow.app.gui.user.reservation.UserReservationStep4Controller">

    <!-- MAIN CONTENT -->
    <BorderPane fx:id="mainLayout">
        <top>
            <HBox alignment="CENTER_LEFT" spacing="20"
                  style="-fx-background-color: white;
                         -fx-padding: 20 40;
                         -fx-border-color: #ddd;
                         -fx-border-width: 0 0 1 0;">
                <Button text="← Geri"
                        onAction="#handleBack"
                        styleClass="big-back-button" />

                <Label text="Adım 4: Koltuk Seçimi"
                       style="-fx-font-size: 24px;
                              -fx-font-weight: 800;
                              -fx-text-fill: #2c3e50;" />

                <Region HBox.hgrow="ALWAYS" />

                <!-- Step2/3 ile uyumlu sağ üst özet -->
                <VBox alignment="CENTER_RIGHT" spacing="2">
                    <Label fx:id="lblTopSummaryDateTime"
                           text="Wed, 12 March | 14:00 - 16:00"
                           style="-fx-font-size: 18px;
                                  -fx-text-fill: #34495e;" />
                    <Label fx:id="lblTopSummaryBlockDesk"
                           text="A Block • Desk 41-50"
                           style="-fx-font-size: 14px;
                                  -fx-text-fill: #5f6c80; -fx-font-weight: 600;" />
                </VBox>
            </HBox>
        </top>

        <center>
            <StackPane style="-fx-background-color: #f4f6f8;">
                <Pane fx:id="seatCanvas"
                      maxHeight="600.0" maxWidth="600.0"
                      minHeight="600.0" minWidth="600.0"
                      style="-fx-background-color: white;
                             -fx-border-color: #e0e3e7;
                             -fx-border-width: 1;
                             -fx-effect: dropshadow(three-pass-box, rgba(15,23,42,0.12), 18, 0, 0, 4);" />
            </StackPane>
        </center>

        <bottom>
            <HBox alignment="CENTER" spacing="30"
                  style="-fx-padding: 15; -fx-background-color: white;">
                <Label text="Renk Açıklaması:" style="-fx-font-weight: bold;" />

                <!-- Müsait -->
                <HBox spacing="5" alignment="CENTER">
                    <Pane prefWidth="20.0" prefHeight="20.0"
                          style="-fx-background-color: #10b981; -fx-background-radius: 5;" />
                    <Label text="Müsait" />
                </HBox>

                <!-- Dolu -->
                <HBox spacing="5" alignment="CENTER">
                    <Pane prefWidth="20.0" prefHeight="20.0"
                          style="-fx-background-color: #64748b; -fx-background-radius: 5;" />
                    <Label text="Dolu" />
                </HBox>
            </HBox>
        </bottom>

    </BorderPane>

    <!-- CONFIRMATION / ERROR / SUCCESS OVERLAY (Modal) -->
    <StackPane fx:id="confirmOverlay"
               visible="false"
               style="-fx-background-color: rgba(0,0,0,0.5);">

        <VBox maxWidth="640"
              spacing="28"
              style="-fx-background-color: white;
                     -fx-padding: 32 44 32 44;
                     -fx-background-radius: 18;
                     -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.5), 20, 0, 0, 0);">

            <VBox spacing="10">
                <Label fx:id="lblModalTitle"
                       text="Confirm Reservation"
                       style="-fx-font-size: 28px;
                              -fx-font-weight: bold;
                              -fx-text-fill: #1f2933;" />
                <Separator />
            </VBox>

            <GridPane hgap="24" vgap="10">
                <Label text="Date:"
                       style="-fx-font-weight: 700;
                              -fx-text-fill: #4b5563;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="0" GridPane.rowIndex="0" />
                <Label fx:id="lblConfirmDate"
                       text="..."
                       style="-fx-text-fill: #111827;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="1" GridPane.rowIndex="0" />

                <Label text="Time:"
                       style="-fx-font-weight: 700;
                              -fx-text-fill: #4b5563;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="0" GridPane.rowIndex="1" />
                <Label fx:id="lblConfirmTime"
                       text="..."
                       style="-fx-text-fill: #111827;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="1" GridPane.rowIndex="1" />

                <Label text="Facility:"
                       style="-fx-font-weight: 700;
                              -fx-text-fill: #4b5563;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="0" GridPane.rowIndex="2" />
                <Label fx:id="lblConfirmFacility"
                       text="..."
                       style="-fx-text-fill: #111827;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="1" GridPane.rowIndex="2" />

                <Label text="Block:"
                       style="-fx-font-weight: 700;
                              -fx-text-fill: #4b5563;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="0" GridPane.rowIndex="3" />
                <Label fx:id="lblConfirmBlock"
                       text="..."
                       style="-fx-text-fill: #111827;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="1" GridPane.rowIndex="3" />

                <Label text="Desk:"
                       style="-fx-font-weight: 700;
                              -fx-text-fill: #4b5563;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="0" GridPane.rowIndex="4" />
                <Label fx:id="lblConfirmDesk"
                       text="..."
                       style="-fx-text-fill: #111827;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="1" GridPane.rowIndex="4" />

                <Label text="Seat:"
                       style="-fx-font-weight: 700;
                              -fx-text-fill: #4b5563;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="0" GridPane.rowIndex="5" />
                <Label fx:id="lblConfirmSeat"
                       text="..."
                       style="-fx-text-fill: #2563eb;
                              -fx-font-weight: bold;
                              -fx-font-size: 18px;"
                       GridPane.columnIndex="1" GridPane.rowIndex="5" />
            </GridPane>

            <!-- Normal uyari mesaji (confirm modunda gorunur) -->
            <Label fx:id="lblWarningMessage"
                   text="Warning: If you do not arrive within 30 minutes of the start time, your reservation may be cancelled."
                   wrapText="true"
                   style="-fx-text-fill: #e67e22;
                          -fx-font-size: 18px;
                          -fx-padding: 6 0 0 0;" />

            <!-- Hata mesaji (error modunda gorunur) -->
            <Label fx:id="lblErrorMessage"
                   text="..."
                   managed="false"
                   visible="false"
                   wrapText="true"
                   style="-fx-text-fill: #e74c3c;
                          -fx-font-size: 18px;
                          -fx-padding: 6 0 0 0;" />

            <!-- Basari mesaji (success modunda gorunur) -->
            <Label fx:id="lblSuccessMessage"
                   text="Your reservation has been created successfully."
                   managed="false"
                   visible="false"
                   wrapText="true"
                   style="-fx-text-fill: #16a34a;
                          -fx-font-size: 18px;
                          -fx-padding: 6 0 0 0;" />

            <!-- Confirm modu butonları -->
            <HBox fx:id="confirmButtonsRow"
                  spacing="16" alignment="CENTER_RIGHT">
                <Button text="Cancel"
                        onAction="#hideOverlay"
                        styleClass="danger-button"
                        style="-fx-font-size: 18px;
                               -fx-padding: 12 32;" />
                <Button text="Confirm &amp; Finish"
                        onAction="#handleConfirm"
                        styleClass="success-button"
                        style="-fx-font-size: 18px;
                               -fx-padding: 12 32;" />
            </HBox>

            <!-- Error modu butonu (OK) -->
            <HBox fx:id="errorButtonsRow"
                  spacing="16"
                  alignment="CENTER_RIGHT"
                  managed="false"
                  visible="false">
                <Region HBox.hgrow="ALWAYS" />
                <Button text="OK"
                        onAction="#handleErrorOk"
                        styleClass="primary-button"
                        style="-fx-font-size: 18px;
                               -fx-padding: 12 32;" />
            </HBox>

            <!-- Success modu butonu (Back to Home) -->
            <HBox fx:id="successButtonsRow"
                  spacing="16"
                  alignment="CENTER_RIGHT"
                  managed="false"
                  visible="false">
                <Region HBox.hgrow="ALWAYS" />
                <Button text="Back to Home"
                        onAction="#handleSuccessHome"
                        styleClass="primary-button"
                        style="-fx-font-size: 18px;
                               -fx-padding: 12 32;" />
            </HBox>
        </VBox>
    </StackPane>

</StackPane>
