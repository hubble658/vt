<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Circle?>

<BorderPane prefHeight="700.0" prefWidth="1200.0" stylesheets="@../../css/styles.css" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.studyflow.app.gui.user.UserProfileController">

    <!-- HEADER -->
    <top>
        <HBox styleClass="header-bar">
            <Button text="â† Panel" onAction="#handleBack" styleClass="big-back-button" />
            <VBox spacing="4" alignment="CENTER_LEFT">
                <Label text="Profilim" styleClass="page-title" />
                <Label text="Ogrenme istatistikleriniz ve aliskanliklariniz" styleClass="page-subtitle" />
            </VBox>
            <Region HBox.hgrow="ALWAYS" />
            <!-- Edit Profile Butonu KaldÄ±rÄ±ldÄ± -->
        </HBox>
    </top>

    <!-- CENTER -->
    <center>
        <StackPane styleClass="content-background">
            <ScrollPane fitToWidth="true" hbarPolicy="NEVER" styleClass="reservation-scroll-container">
                <content>
                    <VBox alignment="TOP_CENTER" spacing="30" style="-fx-padding: 30;">

                        <!-- 1. PROFÄ°L KARTI -->
                        <HBox maxWidth="1000" alignment="CENTER_LEFT" spacing="30" style="-fx-background-color: white; -fx-background-radius: 20; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 10, 0, 0, 4); -fx-padding: 30; -fx-border-color: #e0e0e0; -fx-border-radius: 20;">
                            <StackPane>
                                <Circle radius="40" fill="#f0f2f5" stroke="#e0e0e0" />
                                <Label fx:id="avatarLabel" text="M" style="-fx-font-size: 36px; -fx-font-weight: 800; -fx-text-fill: #4a90e2;" />
                            </StackPane>

                            <VBox spacing="5">
                                <Label fx:id="userNameLabel" text="Mert User" style="-fx-font-size: 26px; -fx-font-weight: 800; -fx-text-fill: #2c3e50;" />
                                <Label fx:id="userEmailLabel" text="mert@studyflow.com" style="-fx-font-size: 16px; -fx-text-fill: #7f8c8d;" />
                                <Label fx:id="userRoleLabel" text="STUDENT" style="-fx-background-color: #e8f4fd; -fx-text-fill: #4a90e2; -fx-padding: 5 12; -fx-background-radius: 8; -fx-font-weight: bold; -fx-font-size: 12px;" />
                            </VBox>
                        </HBox>

                        <!-- 2. Ä°STATÄ°STÄ°K GRID -->
                        <GridPane maxWidth="1000" hgap="25" vgap="25" alignment="CENTER">

                            <!-- KART 1: HAFTALIK SÃœRE -->
                            <VBox GridPane.columnIndex="0" GridPane.rowIndex="0" prefWidth="320" prefHeight="180" styleClass="stat-card">
                                <Label text="Bu Hafta Toplam Sure" styleClass="stat-title" />
                                <Label fx:id="lblTotalTime" text="0h 0m" styleClass="stat-value-big" />
                                <Region VBox.vgrow="ALWAYS" />
                                <HBox alignment="CENTER_LEFT" spacing="8" style="-fx-background-color: #f9fafb; -fx-padding: 8; -fx-background-radius: 8;">
                                    <Label fx:id="lblTrendArrow" text="â†‘" style="-fx-font-size: 18px;" />
                                    <Label fx:id="lblTrendText" text="gecen haftaya gore +0s" styleClass="stat-subtitle" style="-fx-font-weight: bold;" />
                                </HBox>
                            </VBox>

                            <!-- KART 2: VERÄ°MLÄ° SAATLER -->
                            <VBox GridPane.columnIndex="1" GridPane.rowIndex="0" prefWidth="320" prefHeight="180" styleClass="stat-card">
                                <Label text="En Verimli Zaman" styleClass="stat-title" />
                                <HBox alignment="CENTER_LEFT" spacing="20">
                                    <Label text="ðŸŒ™" style="-fx-font-size: 40px;" />
                                    <VBox spacing="2">
                                        <Label fx:id="lblProductiveTime" text="--:--" styleClass="stat-value" />
                                        <Label fx:id="lblProductiveMsg" text="..." styleClass="stat-subtitle" wrapText="true" />
                                    </VBox>
                                </HBox>
                            </VBox>

                            <!-- KART 3: OTURUM DETAYLARI -->
                            <VBox GridPane.columnIndex="2" GridPane.rowIndex="0" prefWidth="320" prefHeight="180" styleClass="stat-card">
                                <Label text="Oturum Analizleri" styleClass="stat-title" />
                                <VBox spacing="12">
                                    <HBox spacing="10"><Label text="Ortalama:" style="-fx-text-fill: #999;" /><Label fx:id="lblAvgSession" text="--d" style="-fx-font-weight: bold; -fx-text-fill: #333;" /></HBox>>
                                    <HBox spacing="10"><Label text="En Uzun:" style="-fx-text-fill: #999;" /><Label fx:id="lblLongestSession" text="--d" style="-fx-font-weight: bold; -fx-text-fill: #333;" /></HBox>>
                                    <HBox spacing="10"><Label text="En Kisa:" style="-fx-text-fill: #999;" /><Label fx:id="lblShortestSession" text="--d" style="-fx-font-weight: bold; -fx-text-fill: #333;" /></HBox>>
                                </VBox>
                            </VBox>

                        </GridPane>

                        <!-- 3. HAFTALIK TREND GRAFÄ°ÄžÄ° -->
                        <VBox maxWidth="1000" style="-fx-background-color: white; -fx-background-radius: 20; -fx-padding: 30; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.08), 10, 0, 0, 4); -fx-border-color: #e0e0e0; -fx-border-radius: 20;">
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label text="ðŸ“ˆ" style="-fx-font-size: 20px;" />
                                <Label text="Haftalik Calisma Trendi (Son 4 Hafta)" style="-fx-font-size: 20px; -fx-font-weight: 800; -fx-text-fill: #2c3e50;" />
                            </HBox>
                            <Separator style="-fx-padding: 15 0;" />

                            <!-- STACKPANE WRAPPER: Grafik ve No Data yazÄ±sÄ± Ã¼st Ã¼ste -->
                            <StackPane>
                                <BarChart fx:id="trendChart" legendVisible="false" animated="true" prefHeight="300" barGap="10" categoryGap="40">
                                    <xAxis><CategoryAxis label="Haftalar" /></xAxis>
                                    <yAxis><NumberAxis label="Calisilan Saatler" /></yAxis>
                                </BarChart>
                                <!-- No Data Label -->
                                <Label fx:id="lblTrendNoData" text="Veri Yok" visible="false" style="-fx-text-fill: #bdc3c7; -fx-font-size: 16px; -fx-font-weight: bold; -fx-opacity: 0.8;" />
                            </StackPane>
                        </VBox>

                        <!-- 4. UZUN DONEM ANALIZ -->
                        <VBox maxWidth="1000" style="-fx-background-color: white; -fx-background-radius: 20; -fx-padding: 30; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.08), 10, 0, 0, 4); -fx-border-color: #e0e0e0; -fx-border-radius: 20;">

                            <HBox alignment="CENTER_LEFT" spacing="20">
                                <HBox alignment="CENTER_LEFT" spacing="10">
                                    <Label text="Uzun Donem Analizi" style="-fx-font-size: 20px; -fx-font-weight: 800; -fx-text-fill: #2c3e50;" />
                                </HBox>

                                <Region HBox.hgrow="ALWAYS" />

                                <!-- Filtreler -->
                                <HBox fx:id="filterBox" spacing="10" alignment="CENTER_RIGHT">
                                    <ComboBox fx:id="periodSelector" prefWidth="180" style="-fx-font-size: 14px;" />
                                    <ComboBox fx:id="monthSelector" prefWidth="150" style="-fx-font-size: 14px;" />
                                </HBox>
                            </HBox>

                            <Separator style="-fx-padding: 15 0;" />

                            <!-- STACKPANE WRAPPER -->
                            <StackPane>
                                <BarChart fx:id="longTermChart" legendVisible="false" animated="true" prefHeight="350" barGap="10" categoryGap="30">
                                    <xAxis><CategoryAxis label="Zaman Araligi" /></xAxis>
                                    <yAxis><NumberAxis label="Calisilan Saatler" /></yAxis>
                                </BarChart>
                                <!-- No Data Label -->
                                <Label fx:id="lblLongTermNoData" text="Bu donem icin veri yok" visible="false" style="-fx-text-fill: #bdc3c7; -fx-font-size: 20px; -fx-font-weight: bold; -fx-opacity: 0.8;" />
                            </StackPane>
                        </VBox>

                    </VBox>
                </content>
            </ScrollPane>
        </StackPane>
    </center>

</BorderPane>